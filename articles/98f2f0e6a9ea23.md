---
title: "[Tauri v2]ts-rsã‚¯ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ã£ã¦Rust(Tauri)ã¨TypeScript(ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰)ã§å‹ã®å…±æœ‰ã‚’è¡Œã†"
emoji: "ğŸŒŸ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["tauri", "rust", "typescript"]
published: false
---

## æ¦‚è¦

Tauri:

https://v2.tauri.app/

ã‚’ä½¿ã†ã¨ã€ã‚¢ãƒ—ãƒªã®æœ¬ä½“éƒ¨åˆ†ã‚’Rustã§è¨˜è¿°ã™ã‚‹ã“ã¨ãŒã§ãã€
UI(ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰)éƒ¨åˆ†ã¯Webã‚µã‚¤ãƒˆã®ãƒã‚¦ãƒã‚¦ã‚’ä½¿ã£ã¦è¨˜è¿°ã§ãã‚‹ã€‚
ã™ãªã‚ã¡ã€å¾Œè€…ã¯TypeScriptãƒ™ãƒ¼ã‚¹ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚„ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ä½œæˆã§ãã‚‹ã€‚
(ä½¿ã‚ãªã„ã“ã¨ã‚‚å‡ºæ¥ã‚‹ãŒã€ã“ã“ã§ã¯TSãƒ™ãƒ¼ã‚¹ã®ä½•ã‹ã‚’ä½¿ã†ã‚‚ã®ã¨ã™ã‚‹)

ã“ã“ã§ã€UIå´(TS)ã¨ã‚¢ãƒ—ãƒªæœ¬ä½“å´(Rust)ã§ã€IPCé€šä¿¡ãªã©ã§æƒ…å ±ã‚’ã‚„ã‚Šå–ã‚Šã™ã‚‹ã“ã¨ãŒã‚ã‚‹ãŒã€
ç•°ãªã‚‹è¨€èªã‚’ã¾ãŸã„ã§ã„ã‚‹ãŸã‚ã€ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ãŒã‚„ã‚„å¤§å¤‰ãªã¨ã“ã‚ãŒã‚ã‚‹ã€‚

ã¤ã¾ã‚Šã€

- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç”¨ã«ã€TypeScriptã®å‹å®šç¾©ã‚’è¨˜è¿°
- ã‚¢ãƒ—ãƒªæœ¬ä½“ç”¨ã«ã€Rustã§structã‚„enumã‚’å®šç¾©

ã¨ã„ã£ãŸå½¢ã§ã€TSå´ã¨Rustå´ã§åŒä¸€ã®æƒ…å ±ã‚’äºŒé‡ã«è¨˜è¿°ã—ãªã„ã¨ã„ã‘ãªããªã‚‹èª²é¡ŒãŒå‡ºã¦ããŸã‚Šã™ã‚‹ã€‚
ã“ã†ãªã‚‹ã¨ã€è¨˜è¿°ãŒå†—é•·ã§å¤§å¤‰ãªã“ã¨ã«åŠ ãˆã€äºŒé‡ç®¡ç†ã¨ãªã‚‹ãŸã‚å°†æ¥çš„ã«ãƒ‡ã‚°ãƒ¬ã®æ‡¸å¿µãŒã§ã¦ãã‚‹(ã¤ã¾ã‚Šã€DRYã§ãªã„)ã€‚

ã“ã®èª²é¡Œã«å¯¾ã—ã¦ã€

https://docs.rs/ts-rs/10.0.0/ts_rs/index.html

ã‚’ä½¿ã†ã“ã¨ã§ã‚ã‚‹ç¨‹åº¦ã¯ãƒã‚·ã«å‡ºæ¥ãã†ã€ã¨ã„ã†ã®ãŒæœ¬è¨˜äº‹ã®å†…å®¹ã¨ãªã‚‹ã€‚

## å®Ÿè·µä¾‹

https://v2.tauri.app/start/create-project/

ãªã©ã‚’è¦‹ã¦è‡ªå‹•ã§ä½œæˆã§ãã‚‹ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ™ãƒ¼ã‚¹ã«ã€é©å®œå¤‰æ›´ã‚’åŠ ãˆã¦ã„ãã€‚

### (æ¤œè¨¼ç’°å¢ƒã®æƒ…å ±ãªã©)

- Linux(WSL2)
  - `WSL ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 2.3.24.0`
  - distribution: fedora40
- Rust: 1.82.0
- Node: v20.18.0

ãã®ä»–ã€

https://v2.tauri.app/start/prerequisites/

ã‚’å‚ç…§ã—ã¦ã€Tauriã‚¢ãƒ—ãƒªã®ãƒ“ãƒ«ãƒ‰ã«å¿…è¦ãªãƒ„ãƒ¼ãƒ«ãªã©ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠãã€‚

### Step 0. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

https://v2.tauri.app/start/create-project/#using-create-tauri-app

ã®ã‚ˆã†ã«ã€

```sh
# ä½¿ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã¯å¥½ã¿ã§é©å®œå¤‰æ›´ã™ã‚‹(npmã‚„yarn, bunãªã©)
pnpm create tauri-app
```

ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚

æœ¬è³ªã§ã¯ãªã„ã®ã§è©³è¿°ã¯ã—ãªã„ãŒã€ä»Šå›ã¯

- ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼: pnpm
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: `TypeScript` + `React`(`vite`ãƒ™ãƒ¼ã‚¹)

ã®ã‚ˆã†ãªæ„Ÿã˜ã§ä½œæˆã—ã¦ã„ã‚‹ã€‚

ã“ã“ã§ã€è‡ªå‹•ä½œæˆã—ãŸã‚µãƒ³ãƒ—ãƒ«ã§ã¯ã€

![](https://storage.googleapis.com/zenn-user-upload/bd55f22ee921-20241022.png)

ã®ã‚ˆã†ãªæ„Ÿã˜ã§ã€Formã«åå‰(name)ã‚’å…¥åŠ›ã—ã€"Greet"ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã“ã¨ã§
Tauriå´ã¸ã®æƒ…å ±ã®é€ä¿¡ã¨ã€Tauriã‹ã‚‰ã®æƒ…å ±å—ä¿¡ã‚’è¡Œã†ä¾‹ãŒåˆã‚ã‹ã‚‰çµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã€‚

è©³ç´°ãªã‚¬ã‚¤ãƒ‰ã¯å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®"Calling Rust from the Frontend":

https://v2.tauri.app/develop/calling-rust/#commands

ã«è¨˜è¿°ã•ã‚Œã¦ã®ã§ãã¡ã‚‰ã‚’å‚ç…§ã•ã‚ŒãŸã„ãŒã€ã¨ã‚Šã‚ãˆãšä»Šå›ã®ä¾‹ã§ã¯

```rust:src-tauri/src/lib.rs(æŠœç²‹)
#[tauri::command]
fn greet(name: &str) -> String {
    format!("Hello, {}! You've been greeted from Rust!", name)
}

// (...)
```

ã®ã‚ˆã†ã«Rustå´ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹é–¢æ•°`greet`ã‚’ã€

```typescript:src/App.tsx(æŠœç²‹)
import { useState } from "react";
// (...)

function App() {
  const [greetMsg, setGreetMsg] = useState("");
  const [name, setName] = useState("");

  async function greet() {
    // Learn more about Tauri commands at https://tauri.app/develop/calling-rust/
    setGreetMsg(await invoke("greet", { name })); // â˜…invokeé–¢æ•°ã‚’ä½¿ã£ã¦ã€Tauriå´ã®å‡¦ç†ã‚’å‘¼ã³å‡ºã—
  }
  return (
    <main className="container">
      <h1>Welcome to Tauri + React</h1>

      {/* (...) */}

      <form
        className="row"
        onSubmit={(e) => {
          e.preventDefault();
          greet(); // â˜… ä¸Šã§å®šç¾©ã—ãŸé–¢æ•°: greetã‚’å®Ÿè¡Œã™ã‚‹ä¸­ã§ã€Tauriã®é–¢æ•°å‘¼ã³å‡ºã—ã‚’è¡Œã†`invoke`ã‚’å®Ÿè¡Œ
        }}
      >
        <input
          id="greet-input"
          onChange={(e) => setName(e.currentTarget.value)}
          placeholder="Enter a name..."
        />
        <button type="submit">Greet</button>
      </form>
      <p>{greetMsg}</p>
    </main>
  );
}

export default App;
```

ã®ã‚ˆã†ãªå½¢ã§å‘¼ã³å‡ºã—ã¦ä½¿ã£ã¦ã„ã‚‹ã€‚

ã“ã“ã§ã€å¤§äº‹ãªã®ãŒ`await invoke("greet", { name })`éƒ¨åˆ†ã«ãªã‚‹ãŒã€
`greet`ã‚’ç¬¬1å¼•æ•°ã«æŒ‡å®šã™ã‚‹éš›ã«ã€

- ç¬¬2å¼•æ•°ã«ä½•ã‚’æŒ‡å®šã™ã‚Œã°è‰¯ã„ã®ã‹
  - ã“ã“ã§ã¯`{ name }`ãŒæ­£è§£ã ãŒã€Tauri(Rust)å´ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ãªã„ã¨è‡ªæ˜ã§ã¯ãªã„
- è¿”ã‚Šå€¤ã®å‹ã¯ã©ã†ãªã£ã¦ã„ã‚‹ã®ã‹
  - ã“ã“ã§ã¯`string`å‹ã‚’æœŸå¾…ã—ã¦ã„ã‚‹ãŒã€ã“ã“ã‚‚åŒæ§˜ã«Tauri(Rust)å´ã®ã‚³ãƒ¼ãƒ‰ã‚’å‚ç…§ã—ãªã„ã¨è‡ªæ˜ã§ãªã„

ã¨ã„ã£ãŸã¨ã“ã‚ãŒã‚ã‚Šã€ã“ã‚ŒãŒã¾ã•ã«å†’é ­éƒ¨åˆ†ã§è¨˜è¿°ã—ã¦ã„ã‚‹èª²é¡Œã¨ãªã£ã¦ã„ã‚‹ã€‚

### Step 1. æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´

ãã“ã§ã€å†’é ­ã§ã‚‚æ›¸ã„ãŸã‚ˆã†ã«[ts-rs](https://docs.rs/ts-rs/10.0.0/ts_rs/index.html)ã‚’ä½¿ã£ã¦Rustã®ã‚³ãƒ¼ãƒ‰ã‹ã‚‰TypeScriptã®å‹ã‚’è‡ªå‹•ç”Ÿæˆã—ã¦ã„ãã€‚

ä½¿ã„æ–¹ã¯

https://github.com/Aleph-Alpha/ts-rs/tree/v10.0.0

ã«å¤§ã¾ã‹ã«æ›¸ã„ã¦ã‚ã‚‹ãŒã€deriveãƒã‚¯ãƒ­ã‚’ä½¿ã£ã¦structã‚„enumã‹ã‚‰typescriptã®å‹ã‚’è‡ªå‹•ç”Ÿæˆå‡ºæ¥ã‚‹ã‚‚ã®ã«ãªã£ã¦ã„ã‚‹ã€‚

ãªãŠã€`cargo test`ã‚’è¡Œã†ã¨å‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã‚‹ä»•æ§˜ã¨ãªã£ã¦ã„ã‚‹ãŒã€
tauriæœ¬ä½“ã®ã‚³ãƒ¼ãƒ‰ã«å«ã‚ã‚‹ã¨å®Ÿè¡Œæ™‚é–“ãŒã‹ãªã‚Šé•·ããªã£ã¦ã—ã¾ã£ã¦ä¸ä¾¿ãªã“ã¨ãŒã‚ã‚‹ã®ã§ã€
ä»Šå›ã¯[workspaceæ©Ÿèƒ½](https://doc.rust-jp.rs/book-ja/ch14-03-cargo-workspaces.html)ã‚’ä½¿ã£ã¦ãƒ¡ã‚¤ãƒ³ã®ã‚¯ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ã¯åˆ†é›¢ã™ã‚‹å½¢ã‚’ã¨ã‚‹ã€‚

ãã“ã§ã€`src-tauri/ipc-if`ã«Rust-TypeScripté–“ã§å…±æœ‰ã™ã‚‹å‹ã‚’å®šç¾©ã™ã‚‹ã ã‘ã®workspaceã‚’åˆ‡ã‚Šã€

```toml:src-tauri/Cargo.toml(è¿½è¨˜åˆ†ã®ã¿æŠœç²‹)
[dependencies]
"ipc-if" = { path = "./ipc-if" } # workspaceã§æ›¸ã„ãŸã‚³ãƒ¼ãƒ‰ã‚’å‘¼ã³å‡ºã›ã‚‹ã‚ˆã†ã«ã—ã¦ãŠã
# (...)

[workspace]
members = ["ipc-if"] # workspaceã®ãƒ¡ãƒ³ãƒãƒ¼ã‚’è¿½åŠ 
```

ã¾ãŸã€`src-tauri/ipc-if`ã§`cargo add ts_rs`ã‚’è¡Œã£ã¦ã€`ts_rs`ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠãã€‚
æ›´ã«ã€Tauriã«ãŠã‘ã‚‹UIå´ã¨ã‚¢ãƒ—ãƒªå´ã®æƒ…å ±ã®ã‚„ã‚Šå–ã‚Šã¯ã€å†…éƒ¨çš„ã«serdeã‚’ä½¿ã£ã¦è¡Œã£ã¦ã„ã‚‹ãŸã‚
`cargo add serde -F derive`ã«ã‚ˆã£ã¦ã€`serde`ã‚‚å…¥ã‚Œã¦ãŠãã€‚
(è©³ç´°ã¯[Passing Arguments](https://v2.tauri.app/develop/calling-rust/#passing-arguments)ãŠã‚ˆã³[Returning Data](https://v2.tauri.app/develop/calling-rust/#returning-data)ãªã©ã‚’å‚ç…§)

:::details (src-tauri/ipc-if/Cargo.toml)

ä»¥ä¸‹ã®ã‚ˆã†ãªæ„Ÿã˜:

```toml:src-tauri/ipc-if/Cargo.toml
[package]
name = "ipc-if"
version = "0.1.0"
edition = "2021"

[dependencies]
serde = { version = "1.0.210", features = ["derive"] }
ts-rs = { version = "10.0.0" }
```

:::

ãã—ã¦ã€â†“ã®ã‚ˆã†ã«å¿…è¦ãªå‹ã‚’struct, enumã®å½¢ã§å®šç¾©ã—ã¦ã„ã:

```rust:src-tauri/ipc-if/src/greet.rs
use serde::{Deserialize, Serialize};
use ts_rs::TS;

#[derive(TS, Deserialize, Serialize)]
#[ts(export, export_to = "greet.ts")]
pub struct GreetArgs {
    pub name: String,
}

#[derive(TS, Deserialize, Serialize)]
#[ts(export, export_to = "greet.ts")]
pub struct GreetResponse {
    pub message: String,
}

// â†“â€»TypeScriptã‹ã‚‰invokeã§å‘¼ã³å‡ºã™é–¢æ•°åã«ç›¸å½“ã™ã‚‹å‹ã‚’ä½œã£ã¦ã„ã‚‹
// (renameæ©Ÿèƒ½ã‚’ä½¿ã£ã¦ã€TSã«ãŠã‘ã‚‹å‹ã®ä¸­èº«ãŒRustã§ã®é–¢æ•°åã¨åŒã˜ã«ãªã‚‹ã‚ˆã†ã«ã™ã‚‹)
#[derive(TS, Deserialize, Serialize)]
#[ts(export, export_to = "greet.ts", rename_all = "snake_case")]
pub enum GreetChannelName {
    Greet,
}
```

- bindingã®ç”Ÿæˆã¨TSã‹ã‚‰ã®å‘¼ã³å‡ºã—
- todo: rustã‹ã‚‰ã®å‘¼ã³å‡ºã—

https://github.com/junkor-1011/tauri-v2-tsrs-example-2024/tree/zenn_20241022_minimal_example

### Step2

(TODO)

https://github.com/junkor-1011/tauri-v2-tsrs-example-2024/tree/zenn_20241022

## ãã®ä»–å€™è£œ

### tauri-spectra

https://github.com/specta-rs/tauri-specta

ã“ã®è¨˜äº‹ã‚’æ›¸ãå§‹ã‚ã¦ã‹ã‚‰å­˜åœ¨ã«æ°—ã¥ã„ãŸã®ã§ğŸ˜”æ®‹å¿µãªãŒã‚‰è©³ç´°ã¯è‰¯ãã‚ã‹ã‚‰ãªã„ã‚‚ã®ã®ã€ä¾¿åˆ©ãã†

ãŸã ã—ã€åŸ·ç­†æ™‚ç‚¹(2024-10-22)ã§ã¯tauri v2ç”¨ã®ã‚‚ã®ã¯ã¾ã stableã§ã¯ãªã„æ¨¡æ§˜ã€‚

ç¾æ™‚ç‚¹ã§ã®ä½¿ç”¨ä¾‹ã¯

https://github.com/specta-rs/tauri-specta/tree/v2.0.0-rc.20/examples/app

ã«ç½®ã‹ã‚Œã¦ãŠã‚Šã€

https://github.com/specta-rs/tauri-specta/blob/v2.0.0-rc.20/examples/app/src-tauri/src/main.rs

ã®ã‚ˆã†ã«ã€Rustå´ã§deriveãƒã‚¯ãƒ­(`spectra::Type`ã‚„`tauri_spectra::Event`ãªã©)ã‚’ã¤ã‘ã¦ãŠãã¨ã€
â†“ã®ã‚ˆã†ã«TypeScriptã®ã‚³ãƒ¼ãƒ‰ã‚’è‡ªå‹•ç”Ÿæˆã§ãã‚‹ã‚‰ã—ã„:

https://github.com/specta-rs/tauri-specta/blob/v2.0.0-rc.20/examples/app/src/bindings.ts

æ—©ãstableã«ãªã‚‹ã®ãŒæœŸå¾…ã•ã‚Œã‚‹ã¨ã“ã‚ã€‚

### rspc

https://www.rspc.dev/

ã“ã¡ã‚‰ã‚‚ç‰¹ã«è‡ªåˆ†ã§ã¯è©¦ã›ã¦ã„ãªã„ãŒã€TypeScriptã®[trpc](https://trpc.io/)ã«å½±éŸ¿ã‚’å—ã‘ã¦ä½œã‚‰ã‚ŒãŸã‚‚ã®ã®ã‚ˆã†ã§ã€
Rustã§æ›¸ã„ãŸãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯ã«TypeScriptã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã§ãã‚‹ã‚‰ã—ã„ï¼Ÿ

Tauriã¨ã®é€£æºæ©Ÿèƒ½ã‚‚ç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚

https://www.rspc.dev/integrations/tauri

ãŒã€åŸ·ç­†æ™‚ç‚¹ã§ã®æœ€æ–°ç‰ˆãŒ[v0.2.0](https://github.com/specta-rs/rspc/releases/tag/v0.2.0)(2024-03-18)ã¨ã‚„ã‚„å¤ããªã£ã¦ãŠã‚Šã€Tauri v2ã§ã†ã¾ãå‹•ã„ã¦ãã‚Œã‚‹ã®ã‹ã¯æœªæ¤œè¨¼ã€‚

ã“ã¡ã‚‰ã‚‚ä»Šå¾Œã®å‹•å‘ãŒæ°—ã«ãªã‚‹ã¨ã“ã‚ã€‚
